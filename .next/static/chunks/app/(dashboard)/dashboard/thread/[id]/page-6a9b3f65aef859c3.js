(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3760],{2394:(e,t,a)=>{"use strict";a.d(t,{$o:()=>i,MN:()=>o,Rh:()=>n,ee:()=>d,iS:()=>h,oB:()=>c,r$:()=>m});var s=a(70404),r=a(76698),l=a(23292);let n=(0,s.xP)({reducerPath:"beadApi",baseQuery:(0,r.cw)({baseUrl:l.x,prepareHeaders:(e,t)=>{let{getState:a}=t,s=a().auth.token;return s&&e.set("Authorization","Bearer ".concat(s)),e}}),tagTypes:["Bead"],endpoints:e=>({getBeads:e.query({query:e=>{let{page_number:t,page_size:a}=e;return"beads/getall?page_number=".concat(t,"&page_size=").concat(a)},providesTags:["Bead"]}),getBeadById:e.query({query:e=>"beads/getById/".concat(e),providesTags:(e,t,a)=>[{type:"Bead",id:a}]}),getBeadByThreadId:e.query({query:e=>{let{threadId:t,page_number:a,page_size:s}=e;return"beads/by-thread/".concat(t,"?page_no=").concat(a,"&page_size=").concat(s)},providesTags:["Bead"]}),addBead:e.mutation({query:e=>({url:"beads/create",method:"POST",body:e}),invalidatesTags:["Bead"]}),updateBead:e.mutation({query:e=>{let{id:t,body:a}=e;return{url:"beads/updateBead/".concat(t),method:"PUT",body:a}},invalidatesTags:(e,t,a)=>{let{id:s}=a;return[{type:"Bead",id:s}]}}),deleteBead:e.mutation({query:e=>({url:"beads/deleteBead/".concat(e),method:"DELETE"}),invalidatesTags:["Bead"]}),uploadBeadImage:e.mutation({query:e=>{let{beadId:t,formData:a}=e;return{url:"beads/uploadImage/".concat(t),method:"POST",body:a}},invalidatesTags:(e,t,a)=>{let{beadId:s}=a;return[{type:"Bead",id:s}]}}),createBeadWithImage:e.mutation({async queryFn(e,t,a,s){let{beadData:r,imageFile:l}=e,n=await s({url:"beads/create",method:"POST",body:r});if(n.error)return{error:n.error};let i=n.data;if(l&&i._id){let e=new FormData;e.append("image",l);let t=await s({url:"beads/uploadImage/".concat(i._id),method:"POST",body:e});if(t.error)return{error:t.error};let a=t.data;a.imageUrl&&await s({url:"beads/updateBead/".concat(i._id),method:"PUT",body:{imageUrl:a.imageUrl}})}return{data:i}},invalidatesTags:["Bead"]})})}),{useGetBeadsQuery:i,useGetBeadByIdQuery:o,useGetBeadByThreadIdQuery:d,useAddBeadMutation:c,useUpdateBeadMutation:u,useDeleteBeadMutation:h,useUploadBeadImageMutation:m,useCreateBeadWithImageMutation:x}=n},21743:(e,t,a)=>{"use strict";a.d(t,{J:()=>n,_:()=>l});var s=a(22345),r=a(29359);let l=s.A.src,n=r.A.src},22345:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s={src:"/_next/static/media/Home1.d066bd30.png",height:600,width:1280,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAMAAACEE47CAAAAJFBMVEUmITcfGzAUFSw9NlYvK0FSPV1bQ22CXoxsU3BiZZU4QWGWdJ6EpSw4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAJUlEQVR4nAXBiQEAMAgCsQPUfvvv2wTXPa9tSGZtBNWTlLAApA8JpQBpA6MCbwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:4}},27781:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,j:()=>n});var s=a(5710);let r={refecthNotification:!1};console.log("initialState",r);let l=(0,s.Z0)({name:"notification",initialState:r,reducers:{setRefetchNotification:(e,t)=>{e.refecthNotification=t.payload}}}),{setRefetchNotification:n}=l.actions,i=l.reducer},29359:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s={src:"/_next/static/media/User.d959280a.svg",height:68,width:68,blurWidth:0,blurHeight:0}},40490:(e,t,a)=>{Promise.resolve().then(a.bind(a,81108))},63293:(e,t,a)=>{"use strict";a.d(t,{$f:()=>c,VL:()=>d,h8:()=>o,i$:()=>n,i0:()=>i,ik:()=>h,xh:()=>u});var s=a(70404),r=a(76698),l=a(23292);let n=(0,s.xP)({reducerPath:"userApi",baseQuery:(0,r.cw)({baseUrl:l.x,prepareHeaders:(e,t)=>{let{getState:a}=t,s=a().auth.token;return s&&e.set("Authorization","Bearer ".concat(s)),e}}),tagTypes:["User"],endpoints:e=>({createUser:e.mutation({query:e=>({url:"User/create",method:"POST",body:e}),invalidatesTags:["User"]}),loginUser:e.mutation({query:e=>({url:"User/login",method:"POST",body:e})}),getAllUsers:e.query({query:()=>"User/getAll",providesTags:["User"]}),getUserById:e.query({query:e=>{let{id:t}=e;return"User/getById/".concat(t)},providesTags:(e,t,a)=>{let{id:s}=a;return[{type:"User",id:s}]}}),uploadProfilePicture:e.mutation({query:e=>{let{id:t,file:a}=e,s=new FormData;return s.append("file",a),{url:"User/uploadImage/".concat(t),method:"POST",body:s}},invalidatesTags:(e,t,a)=>{let{id:s}=a;return[{type:"User",id:s}]}}),updateUserProfile:e.mutation({query:e=>{let{id:t,data:a}=e;return{url:"User/update/".concat(t),method:"PUT",body:a}}})})}),{useCreateUserMutation:i,useLoginUserMutation:o,useGetAllUsersQuery:d,useGetUserByIdQuery:c,useUploadProfilePictureMutation:u,useUpdateUserProfileMutation:h}=n},69234:(e,t,a)=>{"use strict";a.d(t,{j:()=>m});var s=a(95155),r=a(12115),l=a(4516),n=a(38564),i=a(71366),o=a(29676),d=a(35695),c=a(66766),u=a(23292),h=a(21743);let m=e=>{let{bead:t}=e,a=(0,d.useRouter)(),[m,x]=(0,r.useState)(!1),p=t.reviews.length?t.reviews.reduce((e,t)=>e+t.rating,0)/t.reviews.length:0,v=t.ownershipHistory.length?t.ownershipHistory[t.ownershipHistory.length-1].location.name:"Unknown",b="".concat(u.x).concat(null==t?void 0:t.thumbnail);return console.log(b),(0,s.jsxs)("div",{className:"relative bg-[#1c102b] backdrop-blur-md rounded-xl overflow-hidden border border-[#3f2e6a] border-opacity-20    transition-all duration-300 hover:shadow-[0_0_20px_rgb(255,0,93)] cursor-pointer group",onClick:()=>{a.push("/dashboard/beads/".concat(t._id))},onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[(0,s.jsxs)("div",{className:"relative w-full h-48 overflow-hidden",children:[(0,s.jsx)(c.default,{fill:!0,unoptimized:!0,src:t.thumbnail?b:h._,overrideSrc:t.thumbnail?b:h._,alt:t.name||"Bead Image",className:"w-full h-full object-cover transition-transform duration-7000 ease-in-out\n                     ".concat(m?"scale-110 rotate-3":"scale-100 rotate-0")}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-[#FF005D] to-[#00D1FF] opacity-30 transition-opacity duration-500 \n                        ".concat(m?"opacity-50":"opacity-30")}),(0,s.jsx)("div",{className:"absolute inset-0 border-2 border-[#00D1FF] rounded-lg opacity-0 \n                        transition-all duration-700 shadow-[0_0_20px_rgb(255,0,93)]\n                        ".concat(m?"opacity-70 scale-95":"opacity-0 scale-100")})]}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold bg-gradient-to-r from-[#FF005D] to-[#00D1FF] bg-clip-text text-transparent group-hover:text-[#00D1FF] transition-colors",children:t.beadName}),t.type&&(0,s.jsx)("span",{className:"text-xs bg-[#00D1FF] bg-opacity-20 px-2 py-1 rounded-full text-[#8a86a0]",children:t.type})]}),(0,s.jsx)("p",{className:"text-[#8a86a0] text-sm mb-3 line-clamp-2",children:t.description}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-[#8a86a0]",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(l.A,{size:14,className:"text-[#00D1FF]"}),(0,s.jsx)("span",{children:v})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(n.A,{size:14,className:"text-[#FF005D]"}),(0,s.jsx)("span",{children:p?p.toFixed(1):"No ratings"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(i.A,{size:14,className:"text-[#00D1FF]"}),(0,s.jsx)("span",{children:t.stories.length})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(o.A,{size:14,className:"text-[#FF005D]"}),(0,s.jsx)("span",{children:t.ownershipHistory.length})]})]})]}),(0,s.jsx)("div",{className:"absolute -bottom-2 left-0 w-full h-1 bg-gradient-to-r from-[#FF005D] via-[#00D1FF] to-[#00D1FF] opacity-70 group-hover:opacity-100 transition-opacity"})]})}},81108:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>el});var s=a(95155),r=a(12115),l=a(69074),n=a(97939),i=a(66516),o=a(84616),d=a(35695),c=a(69234),u=a(2609),h=a(66766),m=a(49861),x=a(49694),p=a(99840),v=a(13580);let b=e=>{let{label:t,onChange:a,acceptedFormats:l,multiple:n=!1}=e,[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)([]),h=(0,r.useRef)(null),m=e=>{let t=Array.from(e);a(t),x(t)},x=e=>{c(e.map(e=>URL.createObjectURL(e)))};return(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-white mb-2",children:t}),(0,s.jsxs)("div",{onDrop:e=>{e.preventDefault(),o(!1);let t=e.dataTransfer.files;t&&m(t)},onDragOver:e=>{e.preventDefault(),o(!0)},onDragLeave:()=>{o(!1)},className:"w-full p-6 border-2 ".concat(i?"border-blue-500":"border-transparent"," bg-transparent rounded-lg transition-all ease-in-out duration-300 flex flex-col items-center justify-center"),style:{borderImage:"linear-gradient(to right, #FF005D, #00D1FF) 1"},children:[(0,s.jsx)("p",{className:"text-white ".concat(i?"text-blue-500":"text-gray-400"),children:i?"Release to Upload":"Drag and drop images here or click to select"}),(0,s.jsx)("input",{type:"file",ref:h,accept:l,multiple:n,onChange:e=>{let t=e.target.files;t&&m(t)},className:"hidden"}),(0,s.jsx)(u.GradientButton,{variant:"outline",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},children:"Select Files"})]}),(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-4",children:d.map((e,t)=>(0,s.jsx)("div",{className:"w-20 h-20 overflow-hidden rounded-md",children:(0,s.jsx)("img",{src:e,alt:"preview-".concat(t),className:"w-full h-full object-cover"})},t))})]})};var g=a(31992),j=a(66474),f=a(5196),y=a(47863),w=a(53999);function N(e){let{...t}=e;return(0,s.jsx)(g.bL,{"data-slot":"select",...t})}function C(e){let{...t}=e;return(0,s.jsx)(g.WT,{"data-slot":"select-value",...t})}function A(e){let{className:t,size:a="default",children:r,...l}=e;return(0,s.jsxs)(g.l9,{"data-slot":"select-trigger","data-size":a,className:(0,w.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[r,(0,s.jsx)(g.In,{asChild:!0,children:(0,s.jsx)(j.A,{className:"size-4 opacity-50"})})]})}function F(e){let{className:t,children:a,position:r="popper",...l}=e;return(0,s.jsx)(g.ZL,{children:(0,s.jsxs)(g.UC,{"data-slot":"select-content",className:(0,w.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...l,children:[(0,s.jsx)(S,{}),(0,s.jsx)(g.LM,{className:(0,w.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(k,{})]})})}function B(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(g.q7,{"data-slot":"select-item",className:(0,w.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(g.VF,{children:(0,s.jsx)(f.A,{className:"size-4"})})}),(0,s.jsx)(g.p4,{children:a})]})}function S(e){let{className:t,...a}=e;return(0,s.jsx)(g.PP,{"data-slot":"select-scroll-up-button",className:(0,w.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(y.A,{className:"size-4"})})}function k(e){let{className:t,...a}=e;return(0,s.jsx)(g.wn,{"data-slot":"select-scroll-down-button",className:(0,w.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(j.A,{className:"size-4"})})}let U=e=>{let{label:t,name:a,value:r,onChange:l,options:n,readOnly:i=!1,placeholder:o="Select an option",additionalStyles:d=""}=e;return(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-white mb-2",htmlFor:a,children:t}),(0,s.jsxs)(N,{value:String(r),name:a,onValueChange:e=>{null==l||l({target:{name:a,value:e}})},disabled:i,children:[(0,s.jsx)(A,{className:"w-full p-6 text-white bg-transparent border-2 border-transparent ".concat(d),style:{borderImage:"linear-gradient(to right, #FF005D, #00D1FF) 1",outline:"none",color:"white"},children:(0,s.jsx)(C,{placeholder:o,className:"text-white"})}),(0,s.jsx)(F,{children:n.map(e=>(0,s.jsx)(B,{value:String(e.value),children:e.label},e.value))})]})]})};var D=a(2394),R=a(3951),T=a(56671),_=a(43332),I=a(57434),E=a(49954),L=a(33127),z=a(66140),P=a(18686),q=a(7121),G=a(55868);let O=["Round","Oval","Cube","Cylinder","Heart","Star","Bicone","Drop","Petal","Donut"],M=["Matte","Glossy","Metallic","Pearl","Transparent","Opaque","Iridescent"],W=["Metal","Wood","Acrylic","Resin","Ceramic","Stone","Glass","Plastic"],H=e=>{var t;let{isOpen:a,onClose:l,refetchBeads:n,isFetchingBeads:i,threadId:o}=e,[d,c]=(0,r.useState)([]),[h,m]=(0,r.useState)(!1),[g,{isLoading:j}]=(0,D.oB)(),[f]=(0,D.iS)(),[y]=(0,D.r$)(),{user:w}=(0,v.G)(e=>e.auth),N=(0,x.Wx)({initialValues:{beadName:"",threadId:null!=o?o:"",ownerId:null!==(t=null==w?void 0:w.id)&&void 0!==t?t:"",visibility:"Public",beadType:"",material:"",color:"",size:0,shape:"",weight:0,finish:"",productCode:"",description:"",quantity:0,supplier:"",pricePerUnit:0},enableReinitialize:!0,onSubmit:async e=>{var t,a;try{let a=await g(e).unwrap();if(!(null==a?void 0:a.isSuccess)||!(null===(t=a.data)||void 0===t?void 0:t._id))throw Error("Failed to create bead");let s=a.data._id;if(d.length>0){m(!0);let e=new FormData;d.forEach((t,a)=>{e.append("files",t.file)});let t=await y({beadId:s,formData:e}).unwrap();if(!(null==t?void 0:t._id))throw await f(s),Error("Failed to upload images")}(0,T.oR)("Bead created successfully."),c([]),null==n||n(),l(),N.resetForm()}catch(e){console.error("Error creating bead:",e),(0,T.oR)(null!==(a=e.message)&&void 0!==a?a:"Something went wrong."),console.log("jljdljlfjdljlfm",d)}}}),C=e=>{c(t=>{let a=[...t];return URL.revokeObjectURL(a[e].previewUrl),a.splice(e,1),a})};return(0,s.jsx)("div",{children:(0,s.jsx)(p.lG,{open:a,onOpenChange:l,children:(0,s.jsxs)(p.Cf,{className:"min-w-[80vw]",children:[(0,s.jsx)(p.c7,{children:(0,s.jsx)(p.L3,{children:(0,s.jsx)("h2",{className:"text-3xl font-bold",children:"Create a Bead"})})}),(0,s.jsxs)("form",{onSubmit:N.handleSubmit,children:[(0,s.jsx)(R.A,{icon:_.A,label:"Title",type:"text",placeholder:"Enter bead title",value:N.values.beadName,onChange:N.handleChange,name:"beadName"}),(0,s.jsx)(R.A,{icon:I.A,label:"Description",type:"textarea",placeholder:"Enter bead description",value:N.values.description,onChange:N.handleChange,name:"description"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h3",{className:"text-xl font-bold",children:"Inventory Information"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-x-8",children:[(0,s.jsx)(R.A,{icon:E.A,label:"Bead Type",type:"text",placeholder:"Enter bead type",value:N.values.beadType,onChange:N.handleChange,name:"beadType"}),(0,s.jsx)(U,{label:"Material",name:"material",placeholder:"Select bead material",value:N.values.material,onChange:N.handleChange,options:W.map(e=>({value:e,label:e}))}),(0,s.jsx)(R.A,{icon:L.A,label:"Color",type:"text",placeholder:"Enter bead color",value:N.values.color,onChange:N.handleChange,name:"color"}),(0,s.jsx)(R.A,{icon:z.A,label:"Size (in MM)",type:"number",placeholder:"Enter bead size",value:N.values.size,onChange:N.handleChange,name:"size"}),(0,s.jsx)(U,{label:"Shape",name:"shape",placeholder:"Select bead shape",value:N.values.shape,onChange:N.handleChange,options:O.map(e=>({value:e,label:e}))}),(0,s.jsx)(R.A,{icon:P.A,label:"Weight (in Grams)",type:"number",placeholder:"Enter bead weight",value:N.values.weight,onChange:N.handleChange,name:"weight"}),(0,s.jsx)(U,{label:"Finish",name:"finish",placeholder:"Select bead finish",value:N.values.finish,onChange:N.handleChange,options:M.map(e=>({value:e,label:e}))}),(0,s.jsx)(R.A,{icon:q.A,label:"Product Code",type:"text",placeholder:"Enter product code",value:N.values.productCode,onChange:N.handleChange,name:"productCode"}),(0,s.jsx)(R.A,{icon:G.A,label:"price (Per Unit)",type:"number",placeholder:"Enter bead price",value:N.values.pricePerUnit,onChange:N.handleChange,name:"pricePerUnit"})]})]}),(0,s.jsx)(b,{label:"Upload Bead Images",onChange:function(e){if(e&&e.length>0){let t=Array.from(e).map(e=>({file:e,previewUrl:URL.createObjectURL(e)}));c(e=>[...e,...t])}},acceptedFormats:"image/jpeg, image/png",multiple:!0}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"text-white mb-2",children:"Selected Files:"}),(0,s.jsxs)("ul",{className:"text-white space-y-2",children:[d.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-center",children:[(0,s.jsx)("span",{children:e.file.name}),(0,s.jsx)("button",{type:"button",onClick:()=>C(t),className:"ml-2 text-red-500 hover:text-red-400",children:"Remove"})]},t)),0===d.length&&(0,s.jsx)("li",{className:"text-gray-400",children:"No files selected"})]})]}),(0,s.jsxs)("div",{className:"mt-6 flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",className:"accent-[#FF005D]",checked:"Private"===N.values.visibility,onChange:e=>{N.setFieldValue("visibility",e.target.checked?"Private":"Public")},name:"isPrivate"}),(0,s.jsx)("label",{className:"text-white text-sm",children:"Only you or specific people can view this bead."})]}),(0,s.jsxs)(p.Es,{className:"mt-6",children:[(0,s.jsx)(u.GradientButton,{variant:"outline",onClick:l,type:"button",children:"Close"}),(0,s.jsx)(u.GradientButton,{type:"submit",disabled:j||h||i,children:j||h||i?"Saving...":"Save Bead"})]})]})]})})})};var J=a(63293),Q=a(47924),V=a(54416);let Z=e=>{var t;let{isOpen:a,onClose:l,threadId:n}=e,{data:i,isLoading:o}=(0,J.VL)(),[d,{isLoading:c}]=(0,m.ow)(),[h,x]=(0,r.useState)(""),[v,b]=(0,r.useState)([]),[g,j]=(0,r.useState)(""),f=null!==(t=null==i?void 0:i.data)&&void 0!==t?t:[],y=e=>{j(e)};(0,r.useEffect)(()=>{""!==h.trim()?b(f.filter(e=>{var t;return null==e?void 0:null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(h.toLowerCase())})):b([])},[h,f]);let w=async()=>{if(!g||!n)return;let e=await d({email:g,threadId:n}),{isSuccess:t}=null==e?void 0:e.data;t?(T.oR.success("Invitation sent successfully!"),l()):T.oR.error("Failed to send invitation. Try again.")};return(0,s.jsx)("div",{children:(0,s.jsx)(p.lG,{open:a,onOpenChange:l,children:(0,s.jsxs)(p.Cf,{children:[(0,s.jsx)(p.c7,{children:(0,s.jsx)(p.L3,{children:(0,s.jsx)("h2",{className:"text-xl font-bold bg-gradient-to-r from-[#FF005D] to-[#00D1FF] bg-clip-text text-transparent",children:"Add Members"})})}),o?(0,s.jsx)("div",{children:"Loading..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.A,{icon:Q.A,label:"",type:"text",placeholder:"Search by email...",value:h,onChange:e=>x(e.target.value)}),(0,s.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto mt-4",children:""===h.trim()?(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Start typing to search users by email..."}):v.length>0?v.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2 border p-2 rounded-md",children:[(0,s.jsx)("input",{type:"checkbox",checked:g.includes(null==e?void 0:e.email),onChange:()=>y(e.email)}),(0,s.jsx)("span",{children:e.email})]},e._id)):(0,s.jsx)("p",{className:"text-gray-500",children:"No users found."})}),g.length>0&&(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsx)("h4",{className:"font-semibold",children:"Selected Emails:"}),(0,s.jsx)("ul",{className:"list-disc pl-5",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:(0,s.jsxs)("span",{className:"inline-flex items-center rounded-full border px-3 py-1 text-sm text-white bg-transparent",style:{borderImage:"linear-gradient(to right, #FF005D, #00D1FF) 1",borderStyle:"solid",borderWidth:"1px"},children:[g,(0,s.jsx)("button",{className:"ml-2 text-white hover:text-red-500 transition cursor-pointer",onClick:()=>j(g),children:(0,s.jsx)(V.A,{size:14})})]})})})]})]}),(0,s.jsxs)(p.Es,{children:[(0,s.jsx)(u.GradientButton,{variant:"outline",onClick:l,children:"Cancel"}),(0,s.jsx)(u.GradientButton,{onClick:w,children:c?"Sending...":"Send Invitation"})]})]})})})};var X=a(12205),Y=a(91788),$=a(67949);function K(e){let{isOpen:t,onClose:a,imageURL:r,shareURL:l,title:n,description:i=""}=e;console.log("shareURL",r);let o=(0,d.useRouter)(),c=async()=>{try{let e=await fetch(r),t=await e.blob(),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="shared-image.png",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}catch(e){console.error("Download failed",e)}},h=encodeURIComponent(l),m=encodeURIComponent(n),x=encodeURIComponent(i);return(0,s.jsx)(p.lG,{open:t,onOpenChange:e=>e,children:(0,s.jsxs)(p.Cf,{onInteractOutside:e=>e.preventDefault(),onEscapeKeyDown:e=>e.preventDefault(),className:"bg-white","aria-describedby":void 0,children:[(0,s.jsx)(p.c7,{children:(0,s.jsx)("h2",{className:"text-2xl font-bold",children:n})}),(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,s.jsx)("p",{className:"text-center text-sm text-gray-600",children:i}),(0,s.jsx)($.Ot,{url:"https://github.com/next-share",subject:"Next Share",body:"Check out this image: ".concat(r),children:(0,s.jsx)($.aZ,{size:32,round:!0})}),(0,s.jsx)($.uI,{url:window.location.href,quote:"next-share is a social share buttons for your next React apps.",hashtag:"#nextshare",children:(0,s.jsx)($.ik,{size:32,round:!0})})]}),(0,s.jsxs)(p.Es,{className:"flex flex-col gap-3 mt-6",children:[(0,s.jsxs)("div",{className:"flex flex-wrap justify-center gap-3",children:[(0,s.jsx)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=".concat(h),target:"_blank",rel:"noopener noreferrer",children:(0,s.jsx)(u.GradientButton,{variant:"outline",children:"Facebook"})}),(0,s.jsx)("a",{href:"https://twitter.com/intent/tweet?url=".concat(h,"&text=").concat(m),target:"_blank",rel:"noopener noreferrer",children:(0,s.jsx)(u.GradientButton,{variant:"outline",children:"Twitter"})}),(0,s.jsx)("a",{href:"https://www.linkedin.com/shareArticle?mini=true&url=".concat(h,"&title=").concat(m,"&summary=").concat(x),target:"_blank",rel:"noopener noreferrer",children:(0,s.jsx)(u.GradientButton,{variant:"outline",children:"LinkedIn"})})]}),(0,s.jsx)(u.GradientButton,{icon:Y.A,onClick:c,children:"Download Image"}),(0,s.jsx)(u.GradientButton,{onClick:()=>{o.push(a)},children:"Close"})]})]})})}var ee=a(23292),et=a(27781);let ea=e=>{let{isOpen:t,onClose:a,inviteId:l,threadName:n,onSuccessResponse:i}=e,[o,{isLoading:d}]=(0,m.pu)(),[c,h]=(0,r.useState)(!1),[x,b]=(0,r.useState)(!1),g=(0,v.j)(),j=async e=>{if(l&&!d){if("accept"===e)try{let e=await o({inviteId:l,accept:!0}).unwrap();d&&h(!0);let{isSuccess:t}=e;t&&(h(!1),g((0,et.j)(!0)),T.oR.success("Invitation accepted successfully! you are now part of the thread",{position:"top-center"}),i&&i())}catch(e){h(!1),T.oR.error("Failed to accept invitation. Try again."),console.error("Error accepting invitation:",e)}else try{let e=await o({inviteId:l,accept:!1}).unwrap();d&&b(!0);let{isSuccess:t}=e;t&&(b(!1),g((0,et.j)(!0)),T.oR.success("Invitation declined successfully!"),i&&i())}catch(e){b(!1),T.oR.error("Failed to decline invitation. Try again."),console.error("Error declining invitation:",e)}}};return(0,s.jsx)("div",{children:(0,s.jsx)(p.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(p.Cf,{children:[(0,s.jsx)(p.c7,{children:(0,s.jsxs)(p.L3,{className:"text-xl font-bold",children:["Join thread: ",n,"?"]})}),(0,s.jsxs)("div",{className:"mt-4 text-gray-300 text-sm",children:["You've been invited to join the thread ",(0,s.jsxs)("h3",{className:"font-bold",children:['"',n,'".']})," Would you like to accept or decline this invitation?"]}),(0,s.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,s.jsx)(u.GradientButton,{variant:"outline",onClick:()=>j("decline"),disabled:x||c||d,children:x?"Declining...":"Decline"}),(0,s.jsx)(u.GradientButton,{onClick:()=>j("accept"),disabled:x||c||d,children:c?"Accepting...":"Accept"})]})]})})})},es=e=>{let{isOpen:t,onClose:a,inviteId:l,threadName:n,onSuccessResponse:i}=e,[o,{isLoading:d}]=(0,m.pu)(),[c,h]=(0,r.useState)(!1),[x,b]=(0,r.useState)(!1),g=(0,v.j)(),j=async e=>{if(l&&!d){if("accept"===e)try{let e=await o({inviteId:l,accept:!0}).unwrap();d&&h(!0);let{isSuccess:t}=e;t&&(h(!1),g((0,et.j)(!0)),T.oR.success("Invitation accepted successfully! you are now part of the thread",{position:"top-center"}),i&&i())}catch(e){h(!1),T.oR.error("Failed to accept invitation. Try again."),console.error("Error accepting invitation:",e)}else try{let e=await o({inviteId:l,accept:!1}).unwrap();d&&b(!0);let{isSuccess:t}=e;t&&(b(!1),g((0,et.j)(!0)),T.oR.success("Invitation declined successfully!"),i&&i())}catch(e){b(!1),T.oR.error("Failed to decline invitation. Try again."),console.error("Error declining invitation:",e)}}};return(0,s.jsx)("div",{children:(0,s.jsxs)(p.lG,{open:t,children:[(0,s.jsx)(p.LC,{className:"bg-black/10 backdrop-blur-xs fixed inset-0 z-50 pointer-events-none"}),(0,s.jsxs)(p.Cf,{children:[(0,s.jsx)(p.c7,{children:(0,s.jsx)(p.L3,{className:"text-xl font-bold text-red-500",children:"This thread is private"})}),(0,s.jsxs)("div",{className:"mt-4 text-gray-300 text-sm",children:["You need permission to become a member of ",(0,s.jsxs)("h2",{className:"font-bold text-white",children:['"',n,'"']}),". Please request to join."]}),(0,s.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,s.jsx)(u.GradientButton,{variant:"outline",onClick:a,disabled:d,children:"Cancel"}),(0,s.jsx)(u.GradientButton,{onClick:()=>j("request"),disabled:d,children:d?"Requesting...":"Request to Join"})]})]})]})})};var er=a(21743);let el=()=>{var e,t,a,x,p,v,b,g,j,f,y,w,N;let{id:C}=(0,d.useParams)(),A=(0,d.useSearchParams)(),F=A.get("inviteId"),B=A.get("jt"),S=(0,d.useRouter)(),[k,U]=(0,r.useState)(!1),[R,T]=(0,r.useState)(!1),[_,I]=(0,r.useState)(!1),{data:E,isLoading:L}=(0,m.eW)(C),{data:z,isLoading:P,refetch:q,isFetching:G}=(0,D.ee)({threadId:null!=C?C:"",page_number:1,page_size:50}),O=null!==(b=null==E?void 0:E.data[0])&&void 0!==b?b:{},M=null!==(g=null==z?void 0:null===(e=z.data)||void 0===e?void 0:e.data)&&void 0!==g?g:[],[W,J]=(0,r.useState)(!1),[Q,V]=(0,r.useState)(!1),[Y,$]=(0,r.useState)(!1),[et,el]=(0,r.useState)(!1),[en,ei]=(0,r.useState)({qrCode:null,name:""}),[eo,ed]=(0,r.useState)({qrCode:null,title:"",link:document.location.href});return((0,r.useEffect)(()=>{F&&$(!0),B&&el(!0)},[F,B]),(0,r.useEffect)(()=>{I(M.length>=2&&M.filter(e=>e.images.length>0).length>=2)},[M]),L)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsx)("div",{className:"animate-pulse-slow text-[#00D1FF]",children:(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-[#00D1FF] border-t-transparent rounded-full animate-rotate-slow"})})}):O?(0,s.jsxs)("div",{className:"container mx-auto px-4 pb-8 mt-8 space-y-6",children:[(0,s.jsx)("div",{className:"bg-[#1c102b] backdrop-blur-md rounded-xl overflow-hidden border border-[#3f2e6a] border-opacity-20",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-[#00D1FF]",children:O.threadName}),(0,s.jsxs)("div",{className:"flex items-center mt-1 text-sm ",children:[(0,s.jsx)(l.A,{size:16,className:"mr-1"}),(0,s.jsxs)("span",{children:["Created ",new Date(O.created_at).toLocaleDateString()]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(u.GradientButton,{variant:"fill",icon:n.A,onClick:()=>{ei({qrCode:O.qrCode,name:O.threadName}),U(!k)},children:"Show QR Code"}),(0,s.jsx)(u.GradientButton,{variant:"outline",icon:i.A,onClick:()=>S.push("/social-share/thread/".concat(O._id,"?from=").concat(encodeURIComponent(window.location.href))),children:"Share Qr Code"})]})]}),(0,s.jsx)("p",{className:" mb-6",children:null==O?void 0:O.description}),_&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-sm font-medium pb-2",children:"Members"}),(0,s.jsxs)("div",{className:"flex items-center -space-x-2",children:[null==O?void 0:null===(t=O.members)||void 0===t?void 0:t.map((e,t)=>(0,s.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden border-2 border-[#2a1a3d]",style:{zIndex:10-t},children:(0,s.jsx)(h.default,{width:50,height:50,unoptimized:!0,src:e.avatar?ee.x+e.avatar:er.J,alt:e.name,className:"object-cover p-1"})},e._id)),(0,s.jsx)("button",{onClick:()=>V(!0),className:"w-10 h-10 rounded-full bg-[#2a1a3d] bg-opacity-50 flex items-center justify-center ml-2 border-2 border-[#00D1FF] border-dashed hover:bg-[#00D1FF] transition-colors",children:(0,s.jsx)(o.A,{size:16,className:""})})]})]})]})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-[#00D1FF]",children:"Thread Beads"}),(0,s.jsxs)("button",{className:"flex items-center text-[#FF005D] hover:text-[#00D1FF] transition-colors",onClick:()=>J(!0),children:[(0,s.jsx)(o.A,{size:18,className:"mr-1"}),"Add Bead"]})]}),z&&(null==z?void 0:null===(x=z.data)||void 0===x?void 0:null===(a=x.data)||void 0===a?void 0:a.length)>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:null==z?void 0:null===(v=z.data)||void 0===v?void 0:null===(p=v.data)||void 0===p?void 0:p.map(e=>(0,s.jsx)(c.j,{bead:e},null==e?void 0:e._id))}):(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center bg-[#1c102b] backdrop-blur-md rounded-xl overflow-hidden border border-[#3f2e6a] border-opacity-20 border-dashed p-8 text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No Beads Yet"}),(0,s.jsx)("p",{className:" mb-4",children:"This thread doesn't have any beads. Add your first bead to start the collection!"}),(0,s.jsx)(u.GradientButton,{icon:o.A,onClick:()=>J(!0),children:"Add First Bead"})]})]}),(0,s.jsx)(H,{isOpen:W,onClose:()=>J(!1),threadId:C,refetchBeads:q,isFetchingBeads:G}),(0,s.jsx)(Z,{isOpen:Q,onClose:()=>V(!1),threadId:C}),(0,s.jsx)(X.A,{isOpen:k,onClose:()=>{U(!1)},qrURL:null!==(j=en.qrCode)&&void 0!==j?j:"",title:null!==(f=en.name)&&void 0!==f?f:""}),(0,s.jsx)(K,{isOpen:R,onClose:()=>{T(!1)},imageURL:"".concat(null!==ee.x&&void 0!==ee.x?ee.x:"").concat(null!==(y=eo.qrCode)&&void 0!==y?y:""),shareURL:null!==(w=eo.link)&&void 0!==w?w:"",title:null!==(N=eo.title)&&void 0!==N?N:""}),(0,s.jsx)(ea,{inviteId:null!=F?F:"",threadName:O.threadName,isOpen:Y,onClose:()=>{$(!1),S.back()},onSuccessResponse:()=>$(!1)}),(0,s.jsx)(es,{inviteId:null!=F?F:"",threadName:O.threadName,isOpen:et,onClose:()=>{el(!1),S.back()},onSuccessResponse:()=>$(!1)})]}):(0,s.jsxs)("div",{className:"bg-[#1c102b] flex flex-col justify-center items-center backdrop-blur-md rounded-xl overflow-hidden border border-[#3f2e6a] border-opacity-20 p-8 text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-[#FF005D] mb-2",children:"Thread Not Found"}),(0,s.jsx)("p",{className:" mb-4",children:"The thread you're looking for does not exist or has been moved to another dimension."}),(0,s.jsx)(u.GradientButton,{onClick:()=>window.history.back(),children:"Go Back"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4540,6874,5710,404,467,3063,6671,2848,9550,8034,5152,9694,4217,7949,2420,620,8441,1684,7358],()=>t(40490)),_N_E=e.O()}]);